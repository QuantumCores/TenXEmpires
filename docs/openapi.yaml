openapi: 3.0.4
info:
  title: TenX Empires API
  description: REST API for TenX Empires - a turn-based strategy game (Version 1.0)
  contact:
    name: TenX Empires
    url: https://github.com/tenxempires
  version: v1
paths:
  /v1/games:
    get:
      tags:
      - v1
      summary: Lists the authenticated user's games with optional filtering and pagination.
      description: "Returns a paginated list of games for the authenticated user.\r\nRLS (Row-Level Security) is enforced via the session `app.user_id` context variable.\r\n\r\nQuery Parameters:\r\n- status: Filter by game status (active or finished)\r\n- page: 1-based page number (default: 1)\r\n- pageSize: Number of items per page (default: 20, max: 100)\r\n- sort: Sort field - startedAt, lastTurnAt, or turnNo (default: lastTurnAt)\r\n- order: Sort order - asc or desc (default: desc)\r\n\r\nExamples:\r\n- GET /v1/games - All games, sorted by last turn descending\r\n- GET /v1/games?status=active - Active games only\r\n- GET /v1/games?sort=startedAt&order=asc&page=2&pageSize=10 - Second page, sorted by start date ascending\r\n            \r\nSample response:\r\n            \r\n    {\r\n      \"items\": [\r\n        {\r\n          \"id\": 1,\r\n          \"status\": \"active\",\r\n          \"turnNo\": 5,\r\n          \"mapId\": 1,\r\n          \"mapSchemaVersion\": 1,\r\n          \"startedAt\": \"2025-10-20T10:00:00Z\",\r\n          \"finishedAt\": null,\r\n          \"lastTurnAt\": \"2025-10-20T11:30:00Z\"\r\n        }\r\n      ],\r\n      \"page\": 1,\r\n      \"pageSize\": 20,\r\n      \"total\": 15\r\n    }"
      operationId: ListGames
      parameters:
      - name: Status
        in: query
        schema:
          type: string
      - name: Page
        in: query
        schema:
          maximum: 2147483647
          minimum: 1
          type: integer
          format: int32
      - name: PageSize
        in: query
        schema:
          maximum: 100
          minimum: 1
          type: integer
          format: int32
      - name: Sort
        in: query
        schema:
          type: string
      - name: Order
        in: query
        schema:
          type: string
      responses:
        200:
          description: Returns the paged list of games.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameListItemDtoPagedResult'
              example:
                items:
                - id: 1
                  status: active
                  turnNo: 5
                  mapId: 1
                  mapSchemaVersion: 1
                  startedAt: 2025-10-20T10:00:00+00:00
                  finishedAt: 
                  lastTurnAt: 2025-10-20T11:30:00+00:00
                - id: 2
                  status: finished
                  turnNo: 10
                  mapId: 1
                  mapSchemaVersion: 1
                  startedAt: 2025-10-15T14:00:00+00:00
                  finishedAt: 2025-10-15T15:45:00+00:00
                  lastTurnAt: 2025-10-15T15:45:00+00:00
                - id: 3
                  status: active
                  turnNo: 15
                  mapId: 2
                  mapSchemaVersion: 1
                  startedAt: 2025-10-22T09:00:00+00:00
                  finishedAt: 
                  lastTurnAt: 2025-10-23T14:20:00+00:00
                page: 1
                pageSize: 20
                total: 15
        400:
          description: Bad request due to invalid query parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
    post:
      tags:
      - v1
      summary: Creates a new game for the authenticated user.
      description: "Creates a new game instance on a fixed map, initializes participants (human + AI),\r\nseeds starting cities/units, and returns the initial game state.\r\n\r\nThe endpoint supports idempotency via the `X-Tenx-Idempotency-Key` header to prevent duplicate game creation.\r\n\r\nRequest Body:\r\n- mapCode (optional): The map code to use (defaults to \"standard_6x8\" if not provided)\r\n- settings (optional): JSON object with game settings\r\n- displayName (optional): Your display name in the game (defaults to \"Player\" if not provided)\r\n\r\nExample request:\r\n            \r\n    POST /v1/games\r\n    X-Tenx-Idempotency-Key: unique-request-id-123\r\n    \r\n    {\r\n      \"mapCode\": \"standard_6x8\",\r\n      \"settings\": { \"difficulty\": \"normal\" },\r\n      \"displayName\": \"Commander Alex\"\r\n    }\r\n            \r\nThe response includes the full initial game state with all entities (participants, cities, units).\r\nYour AI opponent will be assigned a random historical or fantasy leader name (e.g., \"Charlemagne\", \"Cyrus the Great\")."
      operationId: CreateGame
      requestBody:
        description: The command to create a new game with optional map code, settings, and display name.
        content:
          application/json; version=1.0:
            schema:
              $ref: '#/components/schemas/CreateGameCommand'
          text/json; version=1.0:
            schema:
              $ref: '#/components/schemas/CreateGameCommand'
          application/*+json; version=1.0:
            schema:
              $ref: '#/components/schemas/CreateGameCommand'
      responses:
        201:
          description: Game created successfully. Returns the game ID and initial state.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameCreatedResponse'
              example:
                id: 42
                state:
                  game:
                    id: 42
                    turnNo: 1
                    activeParticipantId: 101
                    turnInProgress: false
                    status: active
                  map:
                    id: 1
                    code: standard_6x8
                    schemaVersion: 1
                    width: 8
                    height: 6
                  participants:
                  - id: 101
                    gameId: 42
                    kind: human
                    userId: a0000000-0000-0000-0000-000000000001
                    displayName: Commander Alex
                    isEliminated: false
                  - id: 102
                    gameId: 42
                    kind: ai
                    userId: 
                    displayName: Genghis Khan
                    isEliminated: false
                  units:
                  - id: 201
                    participantId: 101
                    typeCode: warrior
                    hp: 100
                    hasActed: false
                    tileId: 5
                    row: 0
                    col: 1
                  - id: 202
                    participantId: 102
                    typeCode: warrior
                    hp: 100
                    hasActed: false
                    tileId: 43
                    row: 5
                    col: 7
                  cities:
                  - id: 301
                    participantId: 101
                    hp: 100
                    maxHp: 100
                    tileId: 3
                    row: 0
                    col: 0
                  - id: 302
                    participantId: 102
                    hp: 100
                    maxHp: 100
                    tileId: 45
                    row: 5
                    col: 6
                  cityTiles:
                  - cityId: 301
                    tileId: 3
                  - cityId: 302
                    tileId: 45
                  cityResources:
                  - cityId: 301
                    resourceType: food
                    amount: 5
                  - cityId: 301
                    resourceType: production
                    amount: 2
                  - cityId: 302
                    resourceType: food
                    amount: 5
                  - cityId: 302
                    resourceType: production
                    amount: 2
                  unitDefinitions:
                  - id: 1
                    code: warrior
                    isRanged: false
                    attack: 20
                    defence: 10
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 100
                  - id: 2
                    code: settler
                    isRanged: false
                    attack: 0
                    defence: 5
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 50
                  turnSummary: 
        400:
          description: Bad request due to invalid input.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        409:
          description: Conflict - user has reached the game limit.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        422:
          description: Unprocessable Entity - map schema mismatch or map not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/games/{id}/state:
    get:
      tags:
      - v1
      summary: Gets the current state of a specific game.
      description: "Returns the complete game state including all participants, cities, units, resources, and unit definitions.\r\nThis is the authoritative game state used by clients to render the game.\r\n\r\nThe response includes:\r\n- Game metadata (turn number, active player, status)\r\n- Map information\r\n- All participants and their states\r\n- All units with positions and stats\r\n- All cities with positions and resources\r\n- Unit definitions (for client reference)\r\n\r\nExample response structure:\r\n            \r\n    {\r\n      \"game\": { \"id\": 1, \"turnNo\": 1, \"activeParticipantId\": 1, \"status\": \"active\" },\r\n      \"map\": { \"id\": 1, \"code\": \"standard_6x8\", \"width\": 8, \"height\": 6 },\r\n      \"participants\": [...],\r\n      \"units\": [...],\r\n      \"cities\": [...],\r\n      \"cityTiles\": [...],\r\n      \"cityResources\": [...],\r\n      \"unitDefinitions\": [...]\r\n    }"
      operationId: GetGameState
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      responses:
        200:
          description: Returns the current game state.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameStateDto'
              example:
                game:
                  id: 42
                  turnNo: 5
                  activeParticipantId: 101
                  turnInProgress: false
                  status: active
                map:
                  id: 1
                  code: standard_6x8
                  schemaVersion: 1
                  width: 8
                  height: 6
                participants:
                - id: 101
                  gameId: 42
                  kind: human
                  userId: a0000000-0000-0000-0000-000000000001
                  displayName: Commander Alex
                  isEliminated: false
                - id: 102
                  gameId: 42
                  kind: ai
                  userId: 
                  displayName: Genghis Khan
                  isEliminated: false
                units:
                - id: 201
                  participantId: 101
                  typeCode: warrior
                  hp: 80
                  hasActed: true
                  tileId: 12
                  row: 1
                  col: 4
                - id: 202
                  participantId: 101
                  typeCode: settler
                  hp: 50
                  hasActed: false
                  tileId: 15
                  row: 1
                  col: 7
                - id: 203
                  participantId: 102
                  typeCode: warrior
                  hp: 100
                  hasActed: false
                  tileId: 43
                  row: 5
                  col: 3
                cities:
                - id: 301
                  participantId: 101
                  hp: 100
                  maxHp: 100
                  tileId: 3
                  row: 0
                  col: 3
                - id: 302
                  participantId: 102
                  hp: 85
                  maxHp: 100
                  tileId: 45
                  row: 5
                  col: 5
                cityTiles:
                - cityId: 301
                  tileId: 3
                - cityId: 301
                  tileId: 4
                - cityId: 301
                  tileId: 11
                - cityId: 302
                  tileId: 45
                - cityId: 302
                  tileId: 44
                - cityId: 302
                  tileId: 37
                cityResources:
                - cityId: 301
                  resourceType: food
                  amount: 12
                - cityId: 301
                  resourceType: production
                  amount: 8
                - cityId: 301
                  resourceType: gold
                  amount: 5
                - cityId: 302
                  resourceType: food
                  amount: 8
                - cityId: 302
                  resourceType: production
                  amount: 6
                - cityId: 302
                  resourceType: gold
                  amount: 3
                unitDefinitions:
                - id: 1
                  code: warrior
                  isRanged: false
                  attack: 20
                  defence: 10
                  rangeMin: 0
                  rangeMax: 0
                  movePoints: 2
                  health: 100
                - id: 2
                  code: settler
                  isRanged: false
                  attack: 0
                  defence: 5
                  rangeMin: 0
                  rangeMax: 0
                  movePoints: 2
                  health: 50
                - id: 3
                  code: archer
                  isRanged: true
                  attack: 15
                  defence: 8
                  rangeMin: 2
                  rangeMax: 2
                  movePoints: 2
                  health: 80
                turnSummary: 
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Not Found - game does not exist or user doesn't have access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/games/{id}:
    get:
      tags:
      - v1
      summary: Gets detailed information for a specific game owned by the authenticated user.
      description: >-
        Returns a detailed summary of the game, including metadata like map, turn, status,

        and timing fields. If the game does not exist or is not accessible due to RLS, a 404 is returned.
      operationId: GetGameDetail
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      responses:
        200:
          description: Returns the game details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameDetailDto'
              example:
                id: 42
                userId: a0000000-0000-0000-0000-000000000001
                mapId: 1
                mapSchemaVersion: 1
                turnNo: 5
                activeParticipantId: 101
                turnInProgress: false
                status: active
                startedAt: 2025-10-20T10:00:00+00:00
                finishedAt: 
                lastTurnAt: 2025-10-20T11:30:00+00:00
                settings:
                  difficulty: normal
                  map:
                    code: standard_6x8
                    schemaVersion: 1
        304:
          description: Not Modified
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Not Found - game does not exist or user doesn't have access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
    delete:
      tags:
      - v1
      summary: Deletes a game and all associated child entities owned by the authenticated user.
      description: "Permanently deletes a game and all related entities:\r\n- Participants (human and AI)\r\n- Units and their state\r\n- Cities, city tiles, and city resources\r\n- Game saves (manual and autosave)\r\n- Turn history\r\n\r\nThe operation is transactional - either all entities are deleted or none are.\r\nOnly the game owner can delete their games; attempts to delete games owned by others will return 404.\r\n\r\nThe endpoint supports idempotency via the `X-Tenx-Idempotency-Key` header for safe retries.\r\n\r\n**Warning**: This operation is permanent and cannot be undone.\r\n\r\nExample:\r\n            \r\n    DELETE /v1/games/123\r\n    X-Tenx-Idempotency-Key: unique-request-id-456"
      operationId: DeleteGame
      parameters:
      - name: id
        in: path
        description: The game ID to delete.
        required: true
        schema:
          type: integer
          format: int64
      responses:
        204:
          description: Game successfully deleted.
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Not Found - game does not exist or user doesn't have access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/games/{id}/turns:
    get:
      tags:
      - v1
      summary: Lists committed turns for a specific game with optional sorting and pagination.
      description: "Returns a paginated list of committed turns for the specified game, ordered by turn number or commit timestamp.\r\nThis endpoint is useful for displaying game history and timeline views.\r\n\r\nQuery Parameters:\r\n- page: 1-based page number (default: 1)\r\n- pageSize: Number of items per page (default: 20, max: 100)\r\n- sort: Sort field - turnNo or committedAt (default: turnNo)\r\n- order: Sort order - asc or desc (default: desc)\r\n\r\nExamples:\r\n- GET /v1/games/123/turns - Recent turns first\r\n- GET /v1/games/123/turns?sort=committedAt&order=asc - Chronological order\r\n- GET /v1/games/123/turns?page=2&pageSize=50 - Second page with 50 items\r\n            \r\nSample response:\r\n            \r\n    {\r\n      \"items\": [\r\n        {\r\n          \"id\": 42,\r\n          \"turnNo\": 5,\r\n          \"participantId\": 1,\r\n          \"committedAt\": \"2025-10-20T11:30:00Z\",\r\n          \"durationMs\": 12500,\r\n          \"summary\": { \"actions\": 3, \"unitsMovedCount\": 2 }\r\n        }\r\n      ],\r\n      \"page\": 1,\r\n      \"pageSize\": 20,\r\n      \"total\": 5\r\n    }"
      operationId: ListGameTurns
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      - name: Page
        in: query
        schema:
          maximum: 2147483647
          minimum: 1
          type: integer
          format: int32
      - name: PageSize
        in: query
        schema:
          maximum: 100
          minimum: 1
          type: integer
          format: int32
      - name: Sort
        in: query
        schema:
          type: string
      - name: Order
        in: query
        schema:
          type: string
      responses:
        200:
          description: Returns the paged list of turns.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TurnDtoPagedResult'
              example:
                items:
                - id: 42
                  turnNo: 5
                  participantId: 1
                  committedAt: 2025-10-20T11:30:00+00:00
                  durationMs: 12500
                  summary:
                    actions: 3
                    unitsMovedCount: 2
                    citiesFoundedCount: 0
                - id: 41
                  turnNo: 4
                  participantId: 2
                  committedAt: 2025-10-20T11:20:00+00:00
                  durationMs: 8200
                  summary:
                    actions: 2
                    unitsMovedCount: 1
                    citiesFoundedCount: 1
                - id: 40
                  turnNo: 3
                  participantId: 1
                  committedAt: 2025-10-20T11:10:00+00:00
                  durationMs: 15300
                  summary:
                    actions: 4
                    unitsMovedCount: 3
                    citiesFoundedCount: 0
                - id: 39
                  turnNo: 2
                  participantId: 2
                  committedAt: 2025-10-20T11:00:00+00:00
                  durationMs: 6800
                  summary:
                    actions: 1
                    unitsMovedCount: 1
                    citiesFoundedCount: 0
                - id: 38
                  turnNo: 1
                  participantId: 1
                  committedAt: 2025-10-20T10:50:00+00:00
                  durationMs: 9500
                  summary:
                    actions: 2
                    unitsMovedCount: 2
                    citiesFoundedCount: 0
                page: 1
                pageSize: 20
                total: 5
        400:
          description: Bad request due to invalid query parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Not Found - game does not exist or user doesn't have access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/games/{id}/actions/move:
    post:
      tags:
      - v1
      summary: Moves a unit to a target position in the game.
      description: "Moves a unit along a valid path according to deterministic pathfinding rules (A*, uniform cost).\r\nThe move must satisfy several constraints:\r\n- It must be the human player's turn (not AI turn)\r\n- The unit must belong to the active participant\r\n- The destination must be reachable within the unit's movement points\r\n- The destination tile must not be occupied by another unit (1UPT - one unit per tile)\r\n- The unit must not have already acted this turn\r\n\r\nThe endpoint supports idempotency via the `X-Tenx-Idempotency-Key` header to safely retry moves.\r\n\r\nRequest Body:\r\n- unitId: The ID of the unit to move\r\n- to: Target position with row and col coordinates\r\n\r\nExample request:\r\n            \r\n    POST /v1/games/42/actions/move\r\n    X-Tenx-Idempotency-Key: unique-move-request-123\r\n    \r\n    {\r\n      \"unitId\": 201,\r\n      \"to\": { \"row\": 2, \"col\": 3 }\r\n    }\r\n            \r\nThe response includes the complete updated game state after the move."
      operationId: MoveUnit
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        description: The move command with unit ID and target position.
        content:
          application/json; version=1.0:
            schema:
              $ref: '#/components/schemas/MoveUnitCommand'
          text/json; version=1.0:
            schema:
              $ref: '#/components/schemas/MoveUnitCommand'
          application/*+json; version=1.0:
            schema:
              $ref: '#/components/schemas/MoveUnitCommand'
      responses:
        200:
          description: Move successful. Returns the updated game state.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionStateResponse'
              example:
                state:
                  game:
                    id: 42
                    turnNo: 3
                    activeParticipantId: 101
                    turnInProgress: false
                    status: active
                  map:
                    id: 1
                    code: standard_6x8
                    schemaVersion: 1
                    width: 8
                    height: 6
                  participants:
                  - id: 101
                    gameId: 42
                    kind: human
                    userId: a0000000-0000-0000-0000-000000000001
                    displayName: Commander Alex
                    isEliminated: false
                  - id: 102
                    gameId: 42
                    kind: ai
                    userId: 
                    displayName: Genghis Khan
                    isEliminated: false
                  units:
                  - id: 201
                    participantId: 101
                    typeCode: warrior
                    hp: 100
                    hasActed: true
                    tileId: 13
                    row: 2
                    col: 3
                  - id: 202
                    participantId: 102
                    typeCode: warrior
                    hp: 100
                    hasActed: false
                    tileId: 43
                    row: 5
                    col: 7
                  - id: 203
                    participantId: 101
                    typeCode: settler
                    hp: 50
                    hasActed: false
                    tileId: 7
                    row: 0
                    col: 2
                  cities:
                  - id: 301
                    participantId: 101
                    hp: 100
                    maxHp: 100
                    tileId: 3
                    row: 0
                    col: 0
                  - id: 302
                    participantId: 102
                    hp: 100
                    maxHp: 100
                    tileId: 45
                    row: 5
                    col: 6
                  cityTiles:
                  - cityId: 301
                    tileId: 3
                  - cityId: 302
                    tileId: 45
                  cityResources:
                  - cityId: 301
                    resourceType: food
                    amount: 8
                  - cityId: 301
                    resourceType: production
                    amount: 4
                  - cityId: 302
                    resourceType: food
                    amount: 7
                  - cityId: 302
                    resourceType: production
                    amount: 3
                  unitDefinitions:
                  - id: 1
                    code: warrior
                    isRanged: false
                    attack: 20
                    defence: 10
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 100
                  - id: 2
                    code: settler
                    isRanged: false
                    attack: 0
                    defence: 5
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 50
                  - id: 3
                    code: archer
                    isRanged: true
                    attack: 15
                    defence: 8
                    rangeMin: 2
                    rangeMax: 2
                    movePoints: 2
                    health: 80
                  turnSummary: 
        400:
          description: Bad request due to invalid input.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        409:
          description: Conflict - NOT_PLAYER_TURN, ONE_UNIT_PER_TILE, or NO_ACTIONS_LEFT.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        422:
          description: Unprocessable Entity - ILLEGAL_MOVE (path blocked or out of range).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/games/{id}/actions/attack:
    post:
      tags:
      - v1
      summary: >-
        Executes an attack action from one unit against a target unit using deterministic damage rules.

        Ranged attackers never receive a counterattack. Returns updated game state.
      description: >-
        Validations:

        - It must be the human player's turn

        - Attacker must belong to the active participant and have not acted

        - Target must be an enemy unit and be in range (melee: adjacent; ranged: within [min,max])

        - Ranged units never receive counterattacks


        Returns 409 for NOT_PLAYER_TURN or NO_ACTIONS_LEFT, 422 for OUT_OF_RANGE or INVALID_TARGET.
      operationId: AttackUnit
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        description: The attack command with attacker and target unit IDs.
        content:
          application/json; version=1.0:
            schema:
              $ref: '#/components/schemas/AttackUnitCommand'
            example:
              attackerUnitId: 201
              targetUnitId: 305
          text/json; version=1.0:
            schema:
              $ref: '#/components/schemas/AttackUnitCommand'
            example:
              attackerUnitId: 201
              targetUnitId: 305
          application/*+json; version=1.0:
            schema:
              $ref: '#/components/schemas/AttackUnitCommand'
            example:
              attackerUnitId: 201
              targetUnitId: 305
      responses:
        200:
          description: Returns the updated game state after the attack.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionStateResponse'
              example:
                state:
                  game:
                    id: 42
                    turnNo: 3
                    activeParticipantId: 101
                    turnInProgress: false
                    status: active
                  map:
                    id: 1
                    code: standard_6x8
                    schemaVersion: 1
                    width: 8
                    height: 6
                  participants:
                  - id: 101
                    gameId: 42
                    kind: human
                    userId: a0000000-0000-0000-0000-000000000001
                    displayName: Commander Alex
                    isEliminated: false
                  - id: 102
                    gameId: 42
                    kind: ai
                    userId: 
                    displayName: Genghis Khan
                    isEliminated: false
                  units:
                  - id: 201
                    participantId: 101
                    typeCode: warrior
                    hp: 100
                    hasActed: true
                    tileId: 13
                    row: 2
                    col: 3
                  - id: 202
                    participantId: 102
                    typeCode: warrior
                    hp: 100
                    hasActed: false
                    tileId: 43
                    row: 5
                    col: 7
                  - id: 203
                    participantId: 101
                    typeCode: settler
                    hp: 50
                    hasActed: false
                    tileId: 7
                    row: 0
                    col: 2
                  cities:
                  - id: 301
                    participantId: 101
                    hp: 100
                    maxHp: 100
                    tileId: 3
                    row: 0
                    col: 0
                  - id: 302
                    participantId: 102
                    hp: 100
                    maxHp: 100
                    tileId: 45
                    row: 5
                    col: 6
                  cityTiles:
                  - cityId: 301
                    tileId: 3
                  - cityId: 302
                    tileId: 45
                  cityResources:
                  - cityId: 301
                    resourceType: food
                    amount: 8
                  - cityId: 301
                    resourceType: production
                    amount: 4
                  - cityId: 302
                    resourceType: food
                    amount: 7
                  - cityId: 302
                    resourceType: production
                    amount: 3
                  unitDefinitions:
                  - id: 1
                    code: warrior
                    isRanged: false
                    attack: 20
                    defence: 10
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 100
                  - id: 2
                    code: settler
                    isRanged: false
                    attack: 0
                    defence: 5
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 50
                  - id: 3
                    code: archer
                    isRanged: true
                    attack: 15
                    defence: 8
                    rangeMin: 2
                    rangeMax: 2
                    movePoints: 2
                    health: 80
                  turnSummary: 
        400:
          description: Bad request due to invalid payload.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Not Found - unit does not exist or user doesn't have access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        409:
          description: Conflict - NOT_PLAYER_TURN or NO_ACTIONS_LEFT.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        422:
          description: Unprocessable Entity - OUT_OF_RANGE or INVALID_TARGET.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/games/{id}/end-turn:
    post:
      tags:
      - v1
      summary: Ends the active participant's turn, commits the turn, creates an autosave, and advances to the next participant.
      description: >-
        Triggers end-of-turn systems (regen/harvest/production), writes a Turn record, creates an autosave, and advances turn/participant.

        If the next participant is AI, it may be executed within budgeted time in later steps.
      operationId: EndTurn
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        description: Optional empty command body.
        content:
          application/json; version=1.0:
            schema:
              $ref: '#/components/schemas/EndTurnCommand'
          text/json; version=1.0:
            schema:
              $ref: '#/components/schemas/EndTurnCommand'
          application/*+json; version=1.0:
            schema:
              $ref: '#/components/schemas/EndTurnCommand'
      responses:
        200:
          description: Returns the updated state with turn summary and autosave id.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EndTurnResponse'
              example:
                state:
                  game:
                    id: 42
                    turnNo: 2
                    activeParticipantId: 102
                    turnInProgress: false
                    status: active
                  map:
                    id: 1
                    code: standard_6x8
                    schemaVersion: 1
                    width: 8
                    height: 6
                  participants:
                  - id: 101
                    gameId: 42
                    kind: human
                    userId: a0000000-0000-0000-0000-000000000001
                    displayName: Player
                    isEliminated: false
                  - id: 102
                    gameId: 42
                    kind: ai
                    userId: 
                    displayName: Genghis Khan
                    isEliminated: false
                  units:
                  - id: 201
                    participantId: 101
                    typeCode: warrior
                    hp: 95
                    hasActed: true
                    tileId: 5
                    row: 0
                    col: 1
                  - id: 202
                    participantId: 102
                    typeCode: warrior
                    hp: 100
                    hasActed: false
                    tileId: 43
                    row: 5
                    col: 7
                  cities:
                  - id: 301
                    participantId: 101
                    hp: 100
                    maxHp: 100
                    tileId: 3
                    row: 0
                    col: 0
                  - id: 302
                    participantId: 102
                    hp: 100
                    maxHp: 100
                    tileId: 45
                    row: 5
                    col: 6
                  cityTiles:
                  - cityId: 301
                    tileId: 3
                  - cityId: 302
                    tileId: 45
                  cityResources:
                  - cityId: 301
                    resourceType: wood
                    amount: 7
                  - cityId: 301
                    resourceType: stone
                    amount: 6
                  - cityId: 301
                    resourceType: wheat
                    amount: 8
                  - cityId: 301
                    resourceType: iron
                    amount: 2
                  - cityId: 302
                    resourceType: wood
                    amount: 6
                  - cityId: 302
                    resourceType: stone
                    amount: 6
                  - cityId: 302
                    resourceType: wheat
                    amount: 7
                  - cityId: 302
                    resourceType: iron
                    amount: 1
                  unitDefinitions:
                  - id: 1
                    code: warrior
                    isRanged: false
                    attack: 20
                    defence: 10
                    rangeMin: 0
                    rangeMax: 0
                    movePoints: 2
                    health: 100
                  - id: 2
                    code: slinger
                    isRanged: true
                    attack: 15
                    defence: 8
                    rangeMin: 2
                    rangeMax: 3
                    movePoints: 2
                    health: 60
                  turnSummary: 
                turnSummary:
                  regenAppliedCities: 1
                  harvested:
                    wood: 2
                    stone: 1
                    wheat: 3
                    iron: 0
                  producedUnits:
                  - warrior
                  productionDelayed: 0
                  aiExecuted: false
                autosaveId: 9001
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        409:
          description: Conflict - NOT_PLAYER_TURN or TURN_IN_PROGRESS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/maps/{code}:
    get:
      tags:
      - v1
      summary: Gets metadata for a specific map by code.
      description: "Supports conditional requests via ETag:\r\n- Response includes an ETag header derived from schemaVersion, width, height\r\n- Clients can send If-None-Match header with the ETag value\r\n- If data hasn't changed, returns 304 Not Modified\r\n            \r\nSample response:\r\n            \r\n    {\r\n      \"id\": 1,\r\n      \"code\": \"map-01\",\r\n      \"schemaVersion\": 1,\r\n      \"width\": 20,\r\n      \"height\": 30\r\n    }"
      operationId: GetMapByCode
      parameters:
      - name: code
        in: path
        description: The unique map code.
        required: true
        schema:
          type: string
      responses:
        200:
          description: Returns the map metadata.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MapDto'
              example:
                id: 1
                code: map-01
                schemaVersion: 1
                width: 20
                height: 30
        400:
          description: Bad request due to invalid code parameter.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Map not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        304:
          description: Not Modified - cached version is still valid.
        500:
          description: Internal server error occurred.
  /v1/maps/{code}/tiles:
    get:
      tags:
      - v1
      summary: Gets the list of tiles for a specific map by code.
      description: "Returns tiles for rendering terrain and resources. Supports pagination for large maps.\r\nResults are ordered by row, then column for stable pagination.\r\n\r\nSupports conditional requests via ETag:\r\n- Response includes an ETag header derived from map code, pagination, and tile count\r\n- Clients can send If-None-Match header with the ETag value\r\n- If data hasn't changed, returns 304 Not Modified\r\n            \r\nSample response:\r\n            \r\n    {\r\n      \"items\": [\r\n        {\r\n          \"id\": 1,\r\n          \"row\": 0,\r\n          \"col\": 0,\r\n          \"terrain\": \"grassland\",\r\n          \"resourceType\": \"wheat\",\r\n          \"resourceAmount\": 2\r\n        }\r\n      ],\r\n      \"page\": 1,\r\n      \"pageSize\": 20,\r\n      \"total\": 400\r\n    }"
      operationId: GetMapTiles
      parameters:
      - name: code
        in: path
        description: The unique map code.
        required: true
        schema:
          type: string
      - name: page
        in: query
        description: 'Optional 1-based page number (default: 1).'
        schema:
          type: integer
          format: int32
      - name: pageSize
        in: query
        description: 'Optional page size (default: 20, max: 100).'
        schema:
          type: integer
          format: int32
      responses:
        200:
          description: Returns the paged list of map tiles.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MapTileDtoPagedResult'
              example:
                items:
                - id: 1
                  row: 0
                  col: 0
                  terrain: grassland
                  resourceType: wheat
                  resourceAmount: 2
                - id: 2
                  row: 0
                  col: 1
                  terrain: plains
                  resourceType: 
                  resourceAmount: 0
                - id: 3
                  row: 0
                  col: 2
                  terrain: forest
                  resourceType: wood
                  resourceAmount: 3
                page: 1
                pageSize: 20
                total: 400
        400:
          description: Bad request due to invalid parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Map not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        304:
          description: Not Modified - cached version is still valid.
        500:
          description: Internal server error occurred.
  /v1/games/{id}/saves:
    get:
      tags:
      - v1
      summary: Lists all saves (manual and autosaves) for a specific game.
      description: "Returns two lists: manual saves (slots 1-3) and autosaves (most recent first, max 5 shown).\r\nRLS (Row-Level Security) is enforced via the session `app.user_id` context variable.\r\n\r\nManual saves are user-created snapshots with custom names.\r\nAutosaves are created automatically at the end of each turn.\r\n\r\nExample response:\r\n            \r\n    {\r\n      \"manual\": [\r\n        {\r\n          \"id\": 101,\r\n          \"slot\": 1,\r\n          \"turnNo\": 5,\r\n          \"createdAt\": \"2025-10-20T11:30:00Z\",\r\n          \"name\": \"Before attacking Rome\"\r\n        }\r\n      ],\r\n      \"autosaves\": [\r\n        {\r\n          \"id\": 201,\r\n          \"turnNo\": 7,\r\n          \"createdAt\": \"2025-10-20T14:15:00Z\"\r\n        },\r\n        {\r\n          \"id\": 202,\r\n          \"turnNo\": 6,\r\n          \"createdAt\": \"2025-10-20T13:45:00Z\"\r\n        }\r\n      ]\r\n    }"
      operationId: ListGameSaves
      parameters:
      - name: id
        in: path
        description: The game ID.
        required: true
        schema:
          type: integer
          format: int64
      responses:
        200:
          description: Returns the list of saves.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GameSavesListDto'
              example:
                manual:
                - id: 101
                  slot: 1
                  turnNo: 5
                  createdAt: 2025-10-20T11:30:00+00:00
                  name: Before attacking Rome
                - id: 102
                  slot: 2
                  turnNo: 3
                  createdAt: 2025-10-20T10:15:00+00:00
                  name: Opening strategy
                autosaves:
                - id: 201
                  turnNo: 7
                  createdAt: 2025-10-20T14:15:00+00:00
                - id: 202
                  turnNo: 6
                  createdAt: 2025-10-20T13:45:00+00:00
                - id: 203
                  turnNo: 5
                  createdAt: 2025-10-20T13:20:00+00:00
        401:
          description: Unauthorized - user is not authenticated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        404:
          description: Not Found - game does not exist or user doesn't have access.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProblemDetails'
        500:
          description: Internal server error occurred.
  /v1/unit-definitions:
    get:
      tags:
      - v1
      summary: Gets all unit definitions.
      description: >-
        Returns the static list of unit types and their stats (attack, defense, movement, etc.).

        This data is read-only and cacheable.


        Supports conditional requests via ETag:

        - Response includes an ETag header representing the current data version

        - Clients can send If-None-Match header with the ETag value

        - If data hasn't changed, returns 304 Not Modified


        Sample response:

            {
              "items": [
                {
                  "id": 1,
                  "code": "warrior",
                  "isRanged": false,
                  "attack": 20,
                  "defence": 10,
                  "rangeMin": 0,
                  "rangeMax": 0,
                  "movePoints": 2,
                  "health": 100
                }
              ]
            }
      operationId: GetUnitDefinitions
      responses:
        200:
          description: Returns the list of unit definitions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnitDefinitionDtoItemsResult'
              example:
                items:
                - id: 1
                  code: warrior
                  isRanged: false
                  attack: 20
                  defence: 10
                  rangeMin: 0
                  rangeMax: 0
                  movePoints: 2
                  health: 100
                - id: 2
                  code: archer
                  isRanged: true
                  attack: 15
                  defence: 5
                  rangeMin: 2
                  rangeMax: 3
                  movePoints: 2
                  health: 80
                - id: 3
                  code: cavalry
                  isRanged: false
                  attack: 25
                  defence: 8
                  rangeMin: 0
                  rangeMax: 0
                  movePoints: 4
                  health: 90
        304:
          description: Not Modified - cached version is still valid.
        500:
          description: Internal server error occurred.
  /WeatherForecast:
    get:
      tags:
      - v1
      operationId: GetWeatherForecast
      parameters:
      - name: X-Api-Version
        in: header
        schema:
          type: string
      responses:
        200:
          description: OK
          content:
            text/plain; version=1.0:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WeatherForecast'
            application/json; version=1.0:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WeatherForecast'
            text/json; version=1.0:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WeatherForecast'
components:
  schemas:
    ActionStateResponse:
      type: object
      properties:
        state:
          $ref: '#/components/schemas/GameStateDto'
      additionalProperties: false
    AttackUnitCommand:
      type: object
      properties:
        attackerUnitId:
          type: integer
          format: int64
        targetUnitId:
          type: integer
          format: int64
      additionalProperties: false
    CityInStateDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        participantId:
          type: integer
          format: int64
        hp:
          type: integer
          format: int32
        maxHp:
          type: integer
          format: int32
        tileId:
          type: integer
          format: int64
        row:
          type: integer
          format: int32
        col:
          type: integer
          format: int32
      additionalProperties: false
    CityResourceDto:
      type: object
      properties:
        cityId:
          type: integer
          format: int64
        resourceType:
          type: string
          nullable: true
        amount:
          type: integer
          format: int32
      additionalProperties: false
    CityTileLinkDto:
      type: object
      properties:
        cityId:
          type: integer
          format: int64
        tileId:
          type: integer
          format: int64
      additionalProperties: false
    CreateGameCommand:
      type: object
      properties:
        mapCode:
          type: string
          nullable: true
        settings:
          nullable: true
        displayName:
          type: string
          nullable: true
      additionalProperties: false
    EndTurnCommand:
      type: object
      additionalProperties: false
    EndTurnResponse:
      type: object
      properties:
        state:
          $ref: '#/components/schemas/GameStateDto'
        turnSummary:
          nullable: true
        autosaveId:
          type: integer
          format: int64
      additionalProperties: false
    GameCreatedResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        state:
          $ref: '#/components/schemas/GameStateDto'
      additionalProperties: false
    GameDetailDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userId:
          type: string
          format: uuid
        mapId:
          type: integer
          format: int64
        mapSchemaVersion:
          type: integer
          format: int32
        turnNo:
          type: integer
          format: int32
        activeParticipantId:
          type: integer
          format: int64
          nullable: true
        turnInProgress:
          type: boolean
        status:
          type: string
          nullable: true
        startedAt:
          type: string
          format: date-time
        finishedAt:
          type: string
          format: date-time
          nullable: true
        lastTurnAt:
          type: string
          format: date-time
          nullable: true
        settings:
          nullable: true
      additionalProperties: false
    GameListItemDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        status:
          type: string
          nullable: true
        turnNo:
          type: integer
          format: int32
        mapId:
          type: integer
          format: int64
        mapSchemaVersion:
          type: integer
          format: int32
        startedAt:
          type: string
          format: date-time
        finishedAt:
          type: string
          format: date-time
          nullable: true
        lastTurnAt:
          type: string
          format: date-time
          nullable: true
      additionalProperties: false
    GameListItemDtoPagedResult:
      required:
      - items
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/GameListItemDto'
          nullable: true
        page:
          type: integer
          format: int32
        pageSize:
          type: integer
          format: int32
        total:
          type: integer
          format: int32
          nullable: true
      additionalProperties: false
    GameSavesListDto:
      type: object
      properties:
        manual:
          type: array
          items:
            $ref: '#/components/schemas/SaveManualDto'
          nullable: true
        autosaves:
          type: array
          items:
            $ref: '#/components/schemas/SaveAutosaveDto'
          nullable: true
      additionalProperties: false
    GameStateDto:
      type: object
      properties:
        game:
          $ref: '#/components/schemas/GameStateGameDto'
        map:
          $ref: '#/components/schemas/GameStateMapDto'
        participants:
          type: array
          items:
            $ref: '#/components/schemas/ParticipantDto'
          nullable: true
        units:
          type: array
          items:
            $ref: '#/components/schemas/UnitInStateDto'
          nullable: true
        cities:
          type: array
          items:
            $ref: '#/components/schemas/CityInStateDto'
          nullable: true
        cityTiles:
          type: array
          items:
            $ref: '#/components/schemas/CityTileLinkDto'
          nullable: true
        cityResources:
          type: array
          items:
            $ref: '#/components/schemas/CityResourceDto'
          nullable: true
        unitDefinitions:
          type: array
          items:
            $ref: '#/components/schemas/UnitDefinitionDto'
          nullable: true
        turnSummary:
          nullable: true
      additionalProperties: false
    GameStateGameDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        turnNo:
          type: integer
          format: int32
        activeParticipantId:
          type: integer
          format: int64
          nullable: true
        turnInProgress:
          type: boolean
        status:
          type: string
          nullable: true
      additionalProperties: false
    GameStateMapDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        code:
          type: string
          nullable: true
        schemaVersion:
          type: integer
          format: int32
        width:
          type: integer
          format: int32
        height:
          type: integer
          format: int32
      additionalProperties: false
    GridPosition:
      type: object
      properties:
        row:
          type: integer
          format: int32
        col:
          type: integer
          format: int32
      additionalProperties: false
    MapDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        code:
          type: string
          nullable: true
        schemaVersion:
          type: integer
          format: int32
        width:
          type: integer
          format: int32
        height:
          type: integer
          format: int32
      additionalProperties: false
    MapTileDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        row:
          type: integer
          format: int32
        col:
          type: integer
          format: int32
        terrain:
          type: string
          nullable: true
        resourceType:
          type: string
          nullable: true
        resourceAmount:
          type: integer
          format: int32
      additionalProperties: false
    MapTileDtoPagedResult:
      required:
      - items
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/MapTileDto'
          nullable: true
        page:
          type: integer
          format: int32
        pageSize:
          type: integer
          format: int32
        total:
          type: integer
          format: int32
          nullable: true
      additionalProperties: false
    MoveUnitCommand:
      type: object
      properties:
        unitId:
          type: integer
          format: int64
        to:
          $ref: '#/components/schemas/GridPosition'
      additionalProperties: false
    ParticipantDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        gameId:
          type: integer
          format: int64
        kind:
          type: string
          nullable: true
        userId:
          type: string
          format: uuid
          nullable: true
        displayName:
          type: string
          nullable: true
        isEliminated:
          type: boolean
      additionalProperties: false
    ProblemDetails:
      type: object
      properties:
        type:
          type: string
          nullable: true
        title:
          type: string
          nullable: true
        status:
          type: integer
          format: int32
          nullable: true
        detail:
          type: string
          nullable: true
        instance:
          type: string
          nullable: true
      additionalProperties: {}
    SaveAutosaveDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        turnNo:
          type: integer
          format: int32
        createdAt:
          type: string
          format: date-time
      additionalProperties: false
    SaveManualDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        slot:
          type: integer
          format: int32
        turnNo:
          type: integer
          format: int32
        createdAt:
          type: string
          format: date-time
        name:
          type: string
          nullable: true
      additionalProperties: false
    TurnDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        turnNo:
          type: integer
          format: int32
        participantId:
          type: integer
          format: int64
        committedAt:
          type: string
          format: date-time
        durationMs:
          type: integer
          format: int32
          nullable: true
        summary:
          nullable: true
      additionalProperties: false
    TurnDtoPagedResult:
      required:
      - items
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/TurnDto'
          nullable: true
        page:
          type: integer
          format: int32
        pageSize:
          type: integer
          format: int32
        total:
          type: integer
          format: int32
          nullable: true
      additionalProperties: false
    UnitDefinitionDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        code:
          type: string
          nullable: true
        isRanged:
          type: boolean
        attack:
          type: integer
          format: int32
        defence:
          type: integer
          format: int32
        rangeMin:
          type: integer
          format: int32
        rangeMax:
          type: integer
          format: int32
        movePoints:
          type: integer
          format: int32
        health:
          type: integer
          format: int32
      additionalProperties: false
    UnitDefinitionDtoItemsResult:
      required:
      - items
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/UnitDefinitionDto'
          nullable: true
      additionalProperties: false
    UnitInStateDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        participantId:
          type: integer
          format: int64
        typeCode:
          type: string
          nullable: true
        hp:
          type: integer
          format: int32
        hasActed:
          type: boolean
        tileId:
          type: integer
          format: int64
        row:
          type: integer
          format: int32
        col:
          type: integer
          format: int32
      additionalProperties: false
    WeatherForecast:
      type: object
      properties:
        date:
          type: string
          format: date
        temperatureC:
          type: integer
          format: int32
        temperatureF:
          type: integer
          format: int32
          readOnly: true
        summary:
          type: string
          nullable: true
      additionalProperties: false
